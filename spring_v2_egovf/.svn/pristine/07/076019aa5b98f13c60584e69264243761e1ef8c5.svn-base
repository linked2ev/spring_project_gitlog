<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%><jsp:include page="/WEB-INF/jsp/fo/include/headSurvey.jsp" /><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="stylesheet" href="../../signnaturepad/css/signature-pad.css"><script type="text/javascript">    var _gaq = _gaq || [];    _gaq.push(['_setAccount', 'UA-39365077-1']);    _gaq.push(['_trackPageview']);    (function() {      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);    })();</script></head><body> <!-- header --><jsp:include page="/WEB-INF/jsp/fo/include/header/headerPanel${panelAuth }.jsp" flush="true" /><!-- // header --><!-- main --><main id="main" class="main respWidth">	<div class="containerWrap">	<!-- leftNav -->  	<jsp:include page="/WEB-INF/jsp/fo/include/left/leftPanel${panelAuth }.jsp" flush="true" />	<!-- // leftNav --> 		<div class="pageWrap rndRecrCurr">						<div class="page-title">				<h2><spring:message code="menu.004"/></h2>				<div class="page-location">					<span class="home"><spring:message code="menu.010"/></span> - <spring:message code="menu.003"/> - <b><spring:message code="menu.004"/></b>				</div>			</div>			<div class="page-content">				<div class="searchWrap">					<form id="form" name="form">						<input type="hidden" name="EXAM_MNG_NO" value="<c:out value="${commandMap.EXAM_MNG_NO }"/>"/>						<input type="hidden" name="EXAM_WAY_CD" value="<c:out value="${commandMap.EXAM_WAY_CD }"/>"/>					</form>												<form id="searchForm" name="searchForm">						<input type="hidden" name="EXAM_MNG_NO" value="<c:out value="${commandMap.EXAM_MNG_NO }"/>"/>						<input type="hidden" name="EXAM_WAY_CD" value="<c:out value="${commandMap.EXAM_WAY_CD }"/>"/>										<div class="search-cont">						<div class="search-l">							<dl class="sch-multi">								<dt><spring:message code="search.002"/></dt>								<dd>									<select id="searchTeamGbn" name="searchTeamGbn" title="<spring:message code="search.002"/>" class="inputBox">	                                    <option value="" <c:if test="${empty commandMap.searchTeamGbn }">selected="selected"</c:if>><spring:message code="search.000"/></option>	                                    <c:if test="${not empty SURVEY_GBN_LIST }">	                                        <c:forEach var="codeRow" items="${SURVEY_GBN_LIST }" varStatus="i">	                                            <option value="<c:out value="${codeRow.CODE }"/>" <c:if test="${codeRow.CODE eq commandMap.searchTeamGbn }">selected="selected"</c:if>>	                                                <c:out value="${codeRow.CODE }"/>	                                            </option>	                                        </c:forEach>	                                    </c:if>	                                </select>											</dd>								<dt><spring:message code="search.003"/></dt>								<dd>									<ul class="divForm wd50">										<li>											<select id="searchExamWay" name="searchExamWay" title="<spring:message code="search.003"/>" class="inputBox">												<option value="" <c:if test="${empty commandMap.searchExamWay }">selected="selected"</c:if>><spring:message code="search.000"/></option>			                                    <c:if test="${not empty TEST_PLAN_LIST }">			                                        <c:forEach var="codeRow" items="${TEST_PLAN_LIST }" varStatus="i">			                                            <option value="<c:out value="${codeRow.CODE }"/>" <c:if test="${codeRow.CODE eq commandMap.searchExamWay }">selected="selected"</c:if>>			                                                <c:out value="${codeRow.VALUE }"/>			                                            </option>			                                        </c:forEach>	                                    		</c:if>	                                		</select>											</li>										<li>											<select id="searchVisitArea" name="searchVisitArea" title="<spring:message code="search.004"/>" class="inputBox">												<option value="" <c:if test="${empty commandMap.searchVisitArea }">selected="selected"</c:if>><spring:message code="search.000"/></option>			                                    <c:if test="${not empty VISIT_AREA_LIST }">			                                        <c:forEach var="codeRow" items="${VISIT_AREA_LIST }" varStatus="i">			                                            <option value="<c:out value="${codeRow.CODE }"/>" <c:if test="${codeRow.CODE eq commandMap.searchVisitArea }">selected="selected"</c:if>>			                                                <c:out value="${codeRow.VALUE }"/>			                                            </option>			                                        </c:forEach>			                                    </c:if>			                                </select>																		</li>									</ul>											</dd>							</dl>							<dl class="sch-multi single">								<dt><spring:message code="search.005"/></dt>								<dd><input type="text" id="searchExamTitle" name="searchExamTitle" placeholder="<spring:message code="search.006"/>" class="inputBox" value="<c:out value="${commandMap.searchExamTitle }"/>"></dd>							</dl>						</div>						<div class="search-r">							<div class="search-r-cont">								<button type="button" class="btn btn-search"  id="searchPc"><i class="ico-search"></i><spring:message code="button.000"/></button>							</div>						</div>						<div class="search-r-mobile">							<div class="search-r-cont">								<button type="button" class="btn btn-search" id="searchMb"><i class="ico-search"></i><spring:message code="button.000"/></button>							</div>						</div>					</div>					</form><!-- //searchForm -->				</div><!-- //searchWrap -->				<div class="listWrap">					<ul class="recruit-list recruit-history">						<c:choose>							<c:when test="${not empty list }">								<c:forEach var="row" items="${list}" varStatus="i">									<li>										<div class="recruit-content">											<div class="recruit-l">												<div class="recruit-r">													<div class="recruit-label">													    <c:if test="${row.STATUS eq 'selection'}"><c:set var="STATUS" value="purple" /></c:if>													    <c:if test="${row.STATUS eq 'applying'}"><c:set var="STATUS" value="green" /></c:if>														<span class="label-<c:out value="${STATUS}"/> "> 															<c:if test="${row.STATUS eq 'selection'}"><spring:message code="com.006"/></c:if>															<c:if test="${row.STATUS eq 'applying'}"><spring:message code="com.007"/></c:if>														</span> 													</div>												</div>												<div class="recuit-title">													<a href="#" class="fn_goView" data-exam_mng_no="<c:out value="${row.EXAM_MNG_NO }"/>" data-exam_way_cd="<c:out value="${row.EXAM_WAY_CD }"/>">														<em><c:out value="${row.TEAM_GBN }"/></em>														<c:out value="${row.EXAM_TITLE }"/>													</a>												</div>												<div class="recruit-period">													<span class="recruit-date"><spring:message code="com.004"/> : <c:out value="${row.APP_PERIOD }"/></span>													<span class="exam-date"><spring:message code="com.005"/> : <c:out value="${row.EXAM_PERIOD }"/></span>												</div>												<div class="recruit-tag">													<span><c:out value="${row.EXAM_WAY }"/></span>													<span><c:out value="${row.RECRUIT_WAY }"/></span>												</div>												<div class="recruit-buttons">													<c:if test="${row.VISIT_SCH_YN eq 'Y'}"> 														<button type="button" href="#visitTimeRes" class="fn_visitRes btn btn-3rd btn-gray" data-exam_mng_no="<c:out value="${row.EXAM_MNG_NO }"/>"><spring:message code="button.etc.000"/></button>													</c:if>													<c:if test="${row.SUR_PRE_YN eq 'Y' && row.FINISH_YN eq 'N' && row.VISIT_YN eq 'Y'}">														<button type="button" href="#resultSurvey" class="fn_resultSurvey btn btn-3rd btn-gray" data-exam_mng_no="<c:out value="${row.EXAM_MNG_NO }"/>" data-exam_way_cd="<c:out value="${row.EXAM_WAY_CD }"/>"><spring:message code="button.etc.001"/></button>													</c:if>													<c:if test="${row.AGREE_YN eq 'Y' && row.AGREE_YN1 eq 'Y'}">														<button type="button" href="#agreeSign" class="fn_agreeSign btn btn-3rd btn-gray" data-exam_mng_no="<c:out value="${row.EXAM_MNG_NO }"/>" data-exam_way_cd="<c:out value="${row.EXAM_WAY_CD }"/>"><spring:message code="button.etc.002"/></button>													</c:if>																										<button type="button" class="fn_qnaBoard btn btn-3rd btn-gray" data-exam_mng_no="<c:out value="${row.EXAM_MNG_NO }"/>"><spring:message code="button.etc.003"/></button>																									</div>											</div>										</div>									</li>								</c:forEach>							</c:when>							<c:otherwise>								<div class="tbl-nodata"><div class="no-data"><span><spring:message code="testAppStList.000"/></span></div></div>							</c:otherwise>						</c:choose>					</ul>				</div>	  						</div><!-- // page-content -->		</div><!-- // pageWrap -->  	</div><!-- // container --></main><!-- // main --><!-- popup : 방문예약 --><div class="popupWrap">    <div class="dimBack"></div>    	<!-- 방문예약 -->    <div id="visitTimeRes" class="popupBoxWrap" style="width:600px !important;">         	<form id="visitForm" name="visitForm">   			<input type="hidden" name="EXAM_MNG_NO" value=""/>				<div class="popupBox">			<div class="popup-container">				<div class="popup-header">					<div class="popup-title"><spring:message code="popup.visit.000"/></div>					<div class="popup-close">						<button class="btn-closePop"><i class="ico-close"></i><span class="screen_out"><spring:message code="button.005"/></span></button>					</div>				</div>				<div class="popup-content">					<div class="tblWrap tbl-wm">						<table>							<caption><spring:message code="popup.visit.000"/></caption>							<colgroup>								<col width="20%">								<col width="80%">							</colgroup>							<tbody>								<tr>									<th><spring:message code="popup.visit.001"/></th>									<td>										<select id="VISIT_MNG_NO" name="VISIT_MNG_NO" title="<spring:message code="popup.visit.002"/>" class="inputBox">		                                </select>										</td>								</tr>							</tbody>						</table>					</div>					<div class="btn-wrap btnC">						<button type="button" class="btn btn-prim btn-white btn-closePop"><spring:message code="button.005"/></button>						<button type="button" class="btn btn-prim btn-red" id="fn_visitSave"><spring:message code="button.001"/></button>					</div>				</div><!-- // popup-content -->			</div><!-- // popup-container -->		</div><!-- // popupBox -->				</form>    </div></div><!-- // popup : 글쓰기 --><!-- popup : 동의서서명 --><div class="popupWrap">    <div class="dimBack"></div>    <div id="agreeSign" class="popupBoxWrap" style="width:800px;">    	<form id="signForm" name="signForm">    		<input type="hidden" name="AGREE_SIGN_DATAURL" id="AGREE_SIGN_DATAURL" value="">    		<input type="hidden" name="AGREE_SIGN_ID" id="AGREE_SIGN_ID" value="">   			<input type="hidden" name="AGREE_INCLUSION_YN" id="AGREE_INCLUSION_YN" value="">    		<input type="hidden" name="EXAM_MNG_NO" id="EXAM_MNG_NO" value="">    		<input type="hidden" name="EXAM_TYPE" value="CHO_TYPE">    		<input type="hidden" name="surveyResult" value="">    		    			<div class="popupBox">			<div class="popup-container">				<div class="popup-header">					<div class="popup-title"><spring:message code="popup.agree.000"/></div>					<div class="popup-close">						<button class="btn-closePop"><i class="ico-close"></i><span class="screen_out"><spring:message code="button.005"/></span></button>					</div>				</div>				<div class="popup-content">					<div class="hr-top"></div>										<div class="info-consent consent-box">						<div id="totalHtml" class="consent-box-scroll" style="height: 700px;">														<!-- 1. 임상연구 참가 동의서 -->							<div id="agreeHtml">								<!-- 임상연구 참가 동의서 html -->							</div>								<div class="rsch-signWarp" style="position:relative;">								<div class="rsch-sign-date agreeSignData"> </div>								<div class="rsch-sign-name"><spring:message code="popup.agree.001"/>&nbsp;									<c:out value="${SESSION_NAME}"/>									<a href="#" class="fn_signpadPopup" data-dataurl_id="AGREEMENT_SIGN" title="<spring:message code="popup.agree.002"/>">										<spring:message code="popup.agree.003"/>									</a>								</div>								<div id="AGREEMENT_SIGN" style="width:35%; position:absolute;left:450px;top:10px;z-index:2;"></div>							</div><br/>							 							<HR width="95%" align="center" style="border: solid 1px black;" />															<spring:message code="popup.agree.004"/>														<div class="rsch-signWarp" style="text-align: center; font-size: 20px; position:relative;">								<span class="rsch-sign-name agreeSignData"> </span>								<span class="rsch-sign-name"><spring:message code="popup.agree.005"/>&nbsp;									<span class="researcherNameText">										<!-- 연구자 이름 -->									</span>									<spring:message code="popup.agree.003"/>								</span> 								<div id="AGREEMENT_RESEARCHER_SIGN" style="width:35%; position:absolute;left:320px;top:0px;z-index:2;"></div>							</div><br/><br/><br/><br/><br/>							<!-- //임상연구 참가 동의서 -->														<c:choose>								<c:when test="${LOCALE_LANG eq 'ko'}">																	<!-- 2. 개인정보 수집 · 이용 동의서  -->									<p align="center"><strong><u><span style="font-size: 20px;">개인정보 수집 · 이용 동의서</span></u></strong></p>									<p><br></p>									<p>본인은 ㈜아모레퍼시픽(이하 “회사”)의 임상연구시험에 참여함에 있어 회사가 아래와 같이 개인정보 수집 및 이용함에 동의합니다. 본인은 개인정보의 수집 및 이용에 대한 동의를 거부할 수 있습니다. 단, 동의를 거부하는 경우 시험 참여가 불가합니다.</p>									<p><br></p>									<p><strong>※ 개인정보 수집 및 이용동의</strong><br></p>									<table class="table table-bordered"><tbody><tr><td width="25%" align="center" bgcolor="#d3d3d3">수집항목<br></td><td width="40%" align="center" bgcolor="#d3d3d3">수집 · 이용 목적<br></td><td width="15%" align="center" bgcolor="#d3d3d3">이용 · 보유 기간</td><td width="20%" style="vertical-align: middle;" rowspan="2"><input id="agreeChk1" name="agreeChk1" style="width: 20px; height: 10px;" type="checkbox" value="Y"><label for="agreeChk1">동의합니다</label><br></td></tr><tr><td>성명, 휴대전화번호, 생년월일<br></td><td>시험에 따른 본인식별, 연령 확인, 공지사항 전달 등 의사소통 경로 확보<br></td><td align="center">연구 종료시까지</td></tr></tbody></table>									<p><br></p>									<p><strong>※ 민감정보 수집 및 이용동의</strong><br></p>									<table class="table table-bordered"><tbody><tr><td width="35%" align="center" bgcolor="#d3d3d3">수집항목<br></td><td width="30%" align="center" bgcolor="#d3d3d3">수집 · 이용 목적<br></td><td width="15%" align="center" bgcolor="#d3d3d3">이용 · 보유 기간</td><td width="20%" style="vertical-align: middle;" rowspan="2"><input id="agreeChk2" name="agreeChk2" style="width: 20px; height: 10px;" type="checkbox" value="Y"><label for="agreeChk2">동의합니다</label><br></td></tr><tr><td>임상연구 결과, 피험자선정기준동의서에 표시된 최근 건강상태정보(임신여부, 질환유무 등)<br></td><td>피험자 적격 여부 판단 및 임상연구 진행에 따른 결과 수집<br></td><td align="center">연구 종료시까지</td></tr></tbody></table>									<p><br></p>									<p><strong>※ 개인정보 취급위탁에 대한</strong><br></p>									<table class="table table-bordered"><tbody><tr><td width="40%" align="center" bgcolor="#d3d3d3">취급위탁 받는자<br></td><td width="40%" align="center" bgcolor="#d3d3d3">취급위탁 업무내용<br></td><td width="20%" style="vertical-align: middle;" rowspan="2"><input id="agreeChk3" name="agreeChk3" style="width: 20px; height: 10px;" type="checkbox" value="Y"><label for="agreeChk3">동의합니다</label><br></td></tr><tr><td>CJ 시스템즈<br></td><td>SMS, MMS 등 문자메시지 발송<br></td></tr></tbody></table>									<br/><br/><br/><br/><br/><br/>									<!-- //개인정보 수집 · 이용 동의서  -->															</c:when>								<c:otherwise>																   다국어 작업중								   								</c:otherwise>							</c:choose>																					<!-- 3. 피험자 선정기준 동의서  -->							<p align="center" id="agreeStep3"><strong><u><span style="font-size: 20px;"><spring:message code="popup.agree.007"/></span></u></strong></p>							<div id="agreeSurveyElement" class="surveyWrap">								<!-- 선정기준설문 Survey 영역 -->							</div>  							<div class="rsch-signWarp" style="text-align: center">								<spring:message code="popup.agree.008"/>  :								<input type="radio" id="agreeAble" name="agreeAbleRdo" value="Y" disabled="disabled">								<label for="agreeAble"><spring:message code="popup.agree.009"/></label>								<input type="radio" id="agreeUnAble" name="agreeAbleRdo" value="N" disabled="disabled">								<label for="agreeUnAble"><spring:message code="popup.agree.010"/></label>							</div>														<div class="rsch-signWarp" style="text-align: center; font-size: 20px; position:relative;">								<span class="rsch-sign-name agreeSignData"> </span>								<span class="rsch-sign-name"><spring:message code="popup.agree.005"/>&nbsp;									<span class="researcherNameText">									 	<!-- 연구자 이름 -->									</span>									<spring:message code="popup.agree.003"/> 								</span> 								<div id="CHOICE_RESEARCHER_SIGN" style="width:35%; position:absolute;left:320px;top:0px;z-index:2;"></div>							</div>													</div>					</div>										<div class="btn-wrap btnC">						<button type="button" class="btn btn-prim btn-white btn-closePop" id="fn_agreeSignClose"><spring:message code="button.005"/></button>						<button type="button" class="btn btn-prim btn-red" id="fn_agreeSignSave"><spring:message code="button.001"/></button>					</div>				</div><!-- // popup-content -->			</div><!-- // popup-container -->		</div><!-- // popupBox -->				</form>    </div></div><!-- // popup : 동의서서명 --><!-- popup : 결과설문 작성 --><div class="popupWrap">    <div class="dimBack"></div>    <div id="resultSurvey" class="popupBoxWrap" style="width:800px;">    	<form id="surveyForm" name="surveyForm" enctype="multipart/form-data">    		<input type="hidden" name="surveyResult" value="">    		<input type="hidden" name="EXAM_MNG_NO" value=""/>    		<input type="hidden" name="EXAM_WAY_CD" value=""/>    		<input type="hidden" name="EXAM_ORDER" value=""/>    		<input type="hidden" name="EXAM_TYPE" value="RESULT_TYPE"/>    		<input type="hidden" name="SAVE_TYPE" value=""/>    				<div class="popupBox">				<div class="popup-container">					<div class="popup-header">						<div class="popup-title"><spring:message code="popup.result.000"/></div>						<div class="popup-close">							<button class="btn-closePop"><i class="ico-close"></i><span class="screen_out"><spring:message code="button.005"/></span></button>						</div>					</div>					<div class="popup-content">							<div class="tblWrap tbl-wm">							<table>								<caption><spring:message code="popup.result.001"/></caption>								<colgroup>									<col width="15%">									<col width="35%">									<col width="15%">									<col width="35%">								</colgroup>								<tbody>									<tr>										<th><spring:message code="popup.result.002"/></th>										<td id="EXAM_TITLE_TEXT">  </td>										<th><spring:message code="popup.result.003"/></th>										<td id="EXAM_ORDER_TEXT">  </td>									</tr>									<tr>										<th><spring:message code="popup.result.004"/></th>										<td id="NAME_TEXT">  </td>										<th><spring:message code="popup.result.005"/></th>										<td id="WRITE_DATE_TEXT">  </td>									</tr>									<tr>										<td colspan="4">											<div class="tbl-reset surveyWrap" id="resultSurveyElement" style="overflow-y:scroll; height:500px;">												<!-- 결과설문 Survey 영역 -->											</div>										</td>									</tr>									<tr>										<th><spring:message code="button.file.000"/></th>										<td colspan="3">											<div class="divForm file-box">												<input type="text" id="UPLOAD_FILE_TEXT" class="fileName inputBox" readonly="readonly" style="width:340px;">												<label for="upload-name" class="btn btn-5th btn-blue btn_file"><spring:message code="button.file.001"/></label>												<input type="file" id="upload-name" class="upload-name" name="UPLOAD_FILE_NAME">											</div>										</td>									</tr>								</tbody>							</table>						</div>											<div class="btn-wrap btnC">							<button type="button" class="btn btn-prim btn-white btn-closePop" id="fn_resultSurveyClose"><spring:message code="button.005"/></button>							<button type="button" class="btn btn-prim btn-gray" id="fn_goTempStorage"><spring:message code="button.002"/></button>							<button type="button" class="btn btn-prim btn-white wd100 fn_goPrevious" id="fn_goPrevious"><spring:message code="button.003"/></button>							<button type="button" class="btn btn-prim btn-red wd100 fn_goNext" id="fn_goNext"><spring:message code="button.004"/></button>							<button type="button" class="btn btn-prim btn-red fn_surveySave" id="fn_resultSurveySave"><spring:message code="button.001"/></button>						</div>						</div><!-- // popup-content -->				</div><!-- // popup-container -->			</div><!-- // popupBox -->				</form>    </div></div><!-- // popup : 결과설문 작성 --><!-- popup : 전자서명 --><div class="popupWrap">    <div class="dimBack"></div>    <div id="signPad" class="popupBoxWrap" style="width:800px;"> 		<div class="popupBox">			<div class="popup-container">				<div class="popup-header">					<div class="popup-title" id="signPad_titleText"> </div>					<div class="popup-close">						<button class="btn-closePop" id="signPad_closePop"><i class="ico-close"></i><span class="screen_out">닫기</span></button>					</div>				</div>				<div class="popup-content">				    <div id="signature-pad" class="signature-pad" style="height:400px;">						<div class="signature-pad--body" style="height:250px;">						    <canvas id="canvas"></canvas>  						</div>						<div class="signature-pad--footer"> 						    <div class="description"><spring:message code="button.006"/></div>							    <div class="signature-pad--actions">						        <div>						            <button type="button" class="button clear" id="fn_signPadClear"><spring:message code="button.006"/></button>						        </div>						        <div>						            <button type="button" class="button save" id="fn_signPadSave"><spring:message code="button.001"/></button>						        </div>						    </div>						</div>					</div>				</div><!-- // popup-content -->			</div><!-- // popup-container -->		</div><!-- // popupBox -->    </div></div><!-- //popup : 전자서명 --><!-- footer --><jsp:include page="/WEB-INF/jsp/fo/include/footer.jsp" /><!-- // footer --><script src="../../signnaturepad/js/signature_pad.js"></script><script src="../../signnaturepad/js/app.js"></script><script>var uploadFile = $('.file-box .upload-name');uploadFile.on('change', function(){	if(window.FileReader){		var filename = $(this)[0].files[0].name;	} else {		var filename = $(this).val().split('/').pop().split('\\').pop();	}	$(this).siblings('.fileName').val(filename);});Survey.Survey.cssType = "bootstrap";//_____특수기호 '|' 사용 제한_____var MyTextValidator = (function (_super) {  Survey.__extends(MyTextValidator, _super);  function MyTextValidator() {      _super.call(this);  }  MyTextValidator.prototype.getType = function () { return "mytextvalidator"; };  MyTextValidator.prototype.validate = function (value, name) {      if(value.indexOf("|") >= 0) {          return new Survey.ValidatorResult(null, new Survey.CustomError(this.getErrorText(name)));      }      return null;  };  MyTextValidator.prototype.getDefaultErrorText = function(name) {      return fnLang("'|'는 사용하실 수 없습니다.", "LC00");  }  return MyTextValidator;})(Survey.SurveyValidator);Survey.MyTextValidator = MyTextValidator;Survey.JsonObject.metaData.addClass("mytextvalidator", [], function () { return new MyTextValidator(); }, "surveyvalidator");//__________________________________/** * 선정설문(동의서), 결과설문에서 사용 */var tPage = 0;var cPage = 0;var survey = null;/* survey create */ function surveyCreate (qData, aData, element){	survey = new Survey.Model('{"pages":'+  qData +'}');	survey.requiredText = "";	survey.showNavigationButtons = false;  	survey.questionTitleTemplate = "{no}) {title}"; 	survey.data = jsonParseReturn(aData);		setRequiredAll(survey, true, element);		tPage = survey.pagesValue.length;  // 전체 페이지	cPage = survey.currentPageValue.visibleIndex + 1;		$(".fn_goPrevious").hide();	$(".fn_surveySave").hide();}//surveyPaging(결과설문)surveyPaging = function(){		cPage = survey.currentPageValue.visibleIndex + 1;	if(cPage == 1){ 		$(".fn_goPrevious").hide();	}	if(cPage == 2){		$(".fn_goPrevious").show();	} 	if(tPage <= cPage){		$(".fn_goNext").hide();		$(".fn_surveySave").show();	}else{		$(".fn_goNext").show();		$(".fn_surveySave").hide();	}} //서베이 필수체크 여부 설정   function setRequiredAll(item, required, surveyElement){	var q = item.getAllQuestions(true);	for(var i = 0; i < q.length; i++){		if(typeof q[i].isAllRowRequired != "undefinded" && q[i].isAllRowRequired == false){			q[i].isAllRowRequired = required;		}else{			q[i].isRequired = required;		}	}	item.render(surveyElement);}$(function(){		// 시험방식 변경	var searchExamWay = "<c:out value='${commandMap.searchExamWay }'/>";	if(searchExamWay != "01"){		$("#searchVisitArea").hide();		$("#searchVisitArea").val("");	}    // 시험방식 변경 이벤트    $(document).on("change", "select[name='searchExamWay']", function () {    	if($("select[name='searchExamWay']").val() == '01'){    		$("#searchVisitArea").show();    		$("#searchVisitArea").val("");    	}else{    		$("#searchVisitArea").hide();    		$("#searchVisitArea").val("");    	}    });    // ---------------    	// 조회 버튼 클릭 이벤트    $(document).on("click", ".btn-search", function () {        var $searchForm = $("#searchForm");                $searchForm.attr({"action":"<c:url value='/fo/mp/testApplicationStatusList.do'/>", "target":"_self", "method":"post"}).submit();    });        // 시험모집공고 보기 이벤트    $(document).on("click", ".fn_goView", function () {    	var examMngNo = $(this).data("exam_mng_no");    	var examWayCd = $(this).data("exam_way_cd");    	     	$("input[name='EXAM_MNG_NO']").val(examMngNo);    	$("input[name='EXAM_WAY_CD']").val(examWayCd);    	$("#searchForm").attr({"action":"<c:url value='/fo/ta/testAnnounceView.do'/>", "target":"_self", "method":"post"}).submit();    });        // 방문예약 버튼 클릭 이벤트    $(document).on("click", ".fn_visitRes", function () {    	var examMngNo = $(this).data("exam_mng_no");    	$("#visitForm").find("input[name='EXAM_MNG_NO']").val(examMngNo);    	if(examMngNo != "" && examMngNo != null){          	        	$.ajax({                async : false,                type : "POST",                dataType: "json",                data : {"EXAM_MNG_NO": examMngNo},                url : "<c:url value='/fo/mp/visitTimeAjaxList.do'/>",                success : function (data){                	//console.log(">> VISIT_TIME_LIST:" , data.VISIT_TIME_LIST.length);                    if(data.VISIT_TIME_LIST.length > 0){                     	                    	$("#VISIT_MNG_NO").html("");                    	var str = "";                    	$.each(data.VISIT_TIME_LIST, function(i) {                    		var row = data.VISIT_TIME_LIST[i];                    		str += "<option value=" + row.VISIT_MNG_NO + ">" + row.VISIT_DATE + "</option>";                    	});                    	$("#VISIT_MNG_NO").append(str);                    	                    	layer_popup("#visitTimeRes");                    	                    }else{                        returnMsg.alertMsg(fnLang("해당 시험은 방문예약이 마감되었습니다.", "LC01"));                    }                },                error : function (err){                	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));                }            });                  }else{        	returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC02"));      	}        	});         // 방문예약 > 저장 버튼 클릭 이벤트	$(document).on("click", "#fn_visitSave", function(){		var $visitForm = $("#visitForm");		var examMngNo = $visitForm.find("input[name=EXAM_MNG_NO]").val();		         if(examMngNo != "" && examMngNo != null){          	        	$.ajax({                async : false,                type : "POST",                dataType: "json",                data : $visitForm.serialize(),                url : "<c:url value='/fo/mp/visitTimeAjaxSave.do'/>",                success : function (data){                    if(data.resultYn == 1){                    	returnMsg.alertMsg(fnLang("정상적으로 저장 했습니다.", "LC03"));                    }else{                    	returnMsg.alertMsg(fnLang("저장에 실패했습니다. 다시 시도해주세요.", "LC04"));                    }                    $(".btn-closePop").click();                    return;                },                error : function (err){                	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));                }            });                  }else{        	returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC05"));      	}	});    // 결과설문 버튼 클릭 이벤트    $(document).on("click", ".fn_resultSurvey", function () {    	var $surveyForm = $("#surveyForm");    	var examMngNo = $(this).data("exam_mng_no");    	var examWayCd = $(this).data("exam_way_cd");    	$surveyForm.find("input[name='EXAM_MNG_NO']").val(examMngNo);    	$surveyForm.find("input[name='EXAM_WAY_CD']").val(examWayCd);    	if(examMngNo != "" && examMngNo != null && examWayCd != "" && examWayCd != null){          	        	$.ajax({                async : false,                type : "POST",                dataType: "json",                data : {"EXAM_MNG_NO": examMngNo, "EXAM_WAY_CD": examWayCd},                url : "<c:url value='/fo/mp/resultSurveyAjaxView.do'/>",                success : function (data){                	//console.log(">> [fn_resultSurvey] RESULT_SURVEY_DATA:" , data);                    if(data.data != null){                    	var infoData = data.data;                    	$("#EXAM_TITLE_TEXT").text(infoData.EXAM_TITLE);                    	$("#EXAM_ORDER_TEXT").text(infoData.EXAM_ORDER + " 차");                    	$surveyForm.find("input[name='EXAM_ORDER']").val(infoData.EXAM_ORDER);                    	$("#NAME_TEXT").text(infoData.NAME);                    	$("#WRITE_DATE_TEXT").text(infoData.WRITE_DATE);                      	                    	// 첨부파일                    	if(data.finishInfo != null){                    		$("#UPLOAD_FILE_TEXT").val(data.finishInfo.ORIGIN_FILE_NAME);                    	}                    	                    	surveyCreate(data.surveyTxt, data.answerTxt, "resultSurveyElement");                    	                    	layer_popup("#resultSurvey");                    	                    }else{                    	returnMsg.alertMsg(fnLang("결과설문 호출중에 오류가 발생하였습니다.</br>관리자에게 문의해주세요.", "LC06"));                    }                },                error : function (err){                	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));                }            });                  }else{        	returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC07"));      	}   	}); 	// [결과설문] 이전 버튼 클릭 이벤트	$(document).on("click", "#fn_goPrevious", function(){		$("#surveyForm").find(".sv_prev_btn").trigger("click");		surveyPaging();	});		// [결과설문] 다음 버튼 클릭 이벤트	$(document).on("click", "#fn_goNext", function(){		$("#surveyForm").find(".sv_next_btn").trigger("click");		surveyPaging();	});		// [결과설문] > 임시저장 버튼 클릭 이벤트	$(document).on("click", "#fn_goTempStorage", function(){				// 임시 저장 시 requried 해제		setRequiredAll(survey, false, "surveyElement");				$("#surveyForm").find(".sv_complete_btn").trigger("click");				if(JSON.stringify(survey.data) != "{}"){			$("#surveyForm").find("input[name='surveyResult']").val(JSON.stringify(survey.data)); 		} 				if(survey.isCompleted == true){			// 결과설문(서베이) 등록 호출			fn_insertResultSurvey("TEMP");		}	});		// 결과설문 > 저장 버튼 클릭 이벤트	$(document).on("click", "#fn_resultSurveySave", function(){				$("#surveyForm").find(".sv_complete_btn").trigger("click");		 		if(JSON.stringify(survey.data) != "{}"){			$("#surveyForm").find("input[name='surveyResult']").val(JSON.stringify(survey.data)); 		} 				if(survey.isCompleted == true){			// 결과설문(서베이) 등록 호출			fn_insertResultSurvey("COMPLETE");		}	});     // 동의서 버튼 클릭 이벤트    $(document).on("click", ".fn_agreeSign", function () {    	    	var $signForm = $("#signForm");    	var examMngNo = $(this).data("exam_mng_no");    	$signForm.find("input[name='EXAM_MNG_NO']").val(examMngNo);		    	/* 초기화 */    	$("#AGREE_INCLUSION_YN").val("");    	$("#AGREE_SIGN_DATAURL").val("");		$("#AGREE_SIGN_ID").val("");    	$("#agreeHtml").html("");    	$("#agreeChk1").attr('checked', false);    	$("#agreeChk2").attr('checked', false);        $("#agreeChk3").attr('checked', false);    	$("#agreeStep3").hide();    	$("#agreeSurveyElement").html("");                	if(examMngNo != "" && examMngNo != null){          	        	$.ajax({                async : false,                type : "POST",                dataType: "json",                data : {"EXAM_MNG_NO": examMngNo},                url : "<c:url value='/fo/mp/agreeSignAjaxView.do'/>",                success : function (data){                    if(data.data != null){                    	var agreeData = data.data;                    	$("#agreeHtml").html(agreeData.AGREE_CONTENT);                    	$(".agreeSignData").text(agreeData.AGREE_SIGN_DATE);                    	$signForm.find("input[name='AGREE_INCLUSION_YN']").val(agreeData.AGREE_INCLUSION_YN);                    	$(".researcherNameText").text(agreeData.RESEARCHER_NAME);                    	                     	// Y : 선정기준 포함 시: 선정설문(서베이)                    	if("Y" == agreeData.AGREE_INCLUSION_YN)                    	{                    		$("#agreeStep3").show();                    		surveyCreate(data.surveyTxt, data.answerTxt, "agreeSurveyElement");                    	}                    	                    	layer_popup("#agreeSign");                    }                    else                    {                    	returnMsg.alertMsg(fnLang("동의서서명 데이터 호출중에 오류가 발생하였습니다. 관리자에게 문의해주세요.", "LC08"));                    }                },                error : function (err)                {                	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));                }            });        }    	else        {    		returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC09"));      	}    });        // 사인 패드 팝업 이벤트	$(document).on("click", ".fn_signpadPopup", function () {		//console.log(">> [fn_signpadPopup] ");		var title = $(this).attr("title");           // 사인 title		var dataUrlId = $(this).data("dataurl_id");  // 사인 name id		$("#AGREE_SIGN_ID").val(dataUrlId);		$("#signPad_titleText").text(title);		layer_popup("#signPad");		sign_resizeCanvas();	});	// 사인 삭제	$(document).on("click", "#fn_signPadClear", function (){		signaturePad.clear();	});	// 사인 저장	$(document).on("click", "#fn_signPadSave", function (){		var $signForm = $("#signForm");			    if (signaturePad.isEmpty()) 	    {	        alert("Please provide a signature first.");	    }	    else 	    {	        var dataURL = signaturePad.toDataURL();	        $("#AGREE_SIGN_DATAURL").val(dataURL);	        signaturePad.clear();	        	        var img = document.createElement('img'); // 이미지 객체 생성            img.src = dataURL;            img.style.width = "60%";            document.getElementById("AGREEMENT_SIGN").appendChild(img);                        $("#signPad").find(".btn-closePop").click(); 	     }	});		// 동의서 저장 클릭 이벤트    $(document).on("click", "#fn_agreeSignSave", function () {    	    	var $signForm   = $("#signForm");     	var inclusionYn = $signForm.find("input[name='AGREE_INCLUSION_YN']").val();    	var examMngNo   = $signForm.find("input[name='EXAM_MNG_NO']").val();    			if($("input[name='AGREE_SIGN_ID']").val() == "" || $("input[name='AGREE_SIGN_ID']").val() == null){			$("#AGREEMENT_SIGN").focus();			returnMsg.alertMsg(fnLang("임상연구 참가 동의서에</br>사인해주세요.", "LC10"));			return;		}  		if(!$('input:checkbox[name="agreeChk1"]').is(":checked")){			$("#agreeChk1").focus();			returnMsg.alertMsg(fnLang("개인정보 수집 및 이용동의</br>약관에 동의해주세요.", "LC11"));			return;		}		if(!$('input:checkbox[name="agreeChk2"]').is(":checked")){			returnMsg.alertMsg(fnLang("민감정보 수집 및 이용동의</br>약관에 동의해주세요.", "LC12"));			$("#agreeChk2").focus();			return;		}		if(!$('input:checkbox[name="agreeChk3"]').is(":checked")){			returnMsg.alertMsg(fnLang("개인정보 취급위탁에 대한</br>약관에 동의해주세요.", "LC13"));			$("#agreeChk3").focus();			return;		}     	    	if(examMngNo != "" && examMngNo != null){    		    		// Y : 선정설문 포함 시        	if("Y" == inclusionYn)        	{        		$signForm.find(".sv_complete_btn").trigger("click");        		        		if(JSON.stringify(survey.data) != "{}"){    				$signForm.find("input[name='surveyResult']").val(JSON.stringify(survey.data));    	 		}        		        		if(survey.isCompleted == true){        			// 선정설문(서베이) 등록 호출        			fn_insertSelectionSurvey("COMPLETE");        		}        	}        	// 선정설문 없을 시        	else        	{        		// 사인 등록        		fn_insertSignFinish();        	}        }    	else        {    		returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC14"));      	}    	    });	     // Q&A 버튼 클릭 이벤트    $(document).on("click", ".fn_qnaBoard", function () {    	var $searchForm = $("#searchForm");    	var examMngNo = $(this).data("exam_mng_no");    	    	$searchForm.find("input[name='EXAM_MNG_NO']").val(examMngNo);    	$searchForm.attr({"action":"<c:url value='/fo/mp/qnaBoardList.do'/>", "target":"_self", "method":"post"}).submit();    });   });// 선정설문(서베이) 등록function fn_insertSelectionSurvey(type){	var $signForm = $("#signForm"); 		console.log($signForm.serialize());	//return; 	$.ajax({         async : false,         type : "POST",         dataType: "json",         data :  $signForm.serialize(),         url : "<c:url value='/fo/mj/surveyResultDelete.do'/>",         success : function (data){         	 //console.log(">> [선정설문/동의서(서베이) 삭제]: ", data);             if(data.resultYn != null || data.resultYn != ""){            	 $.ajax({     	        	async : false,     	            type : "POST",     	            dataType: "json",     	            data : $signForm.serialize(),     	            url : "<c:url value='/fo/mj/surveyResultInsert.do'/>",     	            success : function (data){   	                	fn_insertSignFinish();     	            },     	            error : function (err){     	            	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));     	            }     	        });                                 }else{            	 returnMsg.alertMsg(fnLang("선정설문 동의 중에 오류가 발생했습니다. 관리자에게 문의해주세요.", "LC16"), "reload");             }         },         error : function (err){        	 returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));         }	});}// 사인 저장function fn_insertSignFinish(){	var $signForm = $("#signForm");		if($("#AGREE_SIGN_ID").val() == null || $("#AGREE_SIGN_ID").val() == ""){		returnMsg.alertMsg(fnLang("데이터 호출 중에 실패했습니다. 다시 시도해주세요.", "LC17"), "reload");		return;	}		$.ajax({  	    async : false,	    type : "POST",	    dataType: "json",	    data : $signForm.serialize(),	    url : "/fo/mp/agreeSignSave.do", 	    success : function (data){	    	returnMsg.alertMsg(fnLang("정상적으로 동의서서명을 했습니다.", "LC18"),"",function(){ $(".btn-search").trigger("click"); });	    },	    error : function (err)	    {	    	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));	    }	});}// 결과설문(서베이) 등록function fn_insertResultSurvey(type){	var $surveyForm = $("#surveyForm");	$surveyForm.find("input[name='SAVE_TYPE']").val(type);		$.ajax({            async : false,            type : "POST",            dataType: "json",            data : $surveyForm.serialize(),            url : "<c:url value='/fo/mj/surveyResultDelete.do'/>",            success : function (data){                if(data.resultYn != null || data.resultYn != ""){					                	var form = $("#surveyForm")[0];           	        var params = new FormData(form);           	                        	$.ajax({        	        	async : false,        	            type : "POST",        	            enctype: "multipart/form-data",        	            dataType: "json",        	            contentType: false,        	            processData: false,        	            data : params,        	            url : "<c:url value='/fo/mj/surveyResultInsert.do'/>",        	            success : function (data){       	                	returnMsg.alertMsg(fnLang("정상적으로 결과설문을 했습니다.", "LC19"),"",function(){ $(".btn-search").trigger("click"); });        	            },        	            error : function (err){        	            	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));        	            }        	        });                                       }else{                	returnMsg.alertMsg(fnLang("결과설문 동의 중에 오류가 발생했습니다. 관리자에게 문의해주세요.", "LC21"), "reload");                }            },            error : function (err){            	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status));            }	});}</script></body></html>