<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="SMSManage">


    <!-- 회원가입 후 안내 메시지 > SMS 전송 정보 입력 -->
    <insert id="sendSmsJoinMessage" parameterClass="HashMap">
	        /* SMSManage.sendSmsJoinMessage */
			INSERT INTO 
				SMS_MSG 
					(
						MSGKEY
						,REQDATE
						,ID
						,STATUS
						,TYPE
						,PHONE       /* 수신번호 */
						,CALLBACK    /* 발신번호 */
						,MSG
						,ETC1
						,ETC2
					) 
			VALUES    
					(
					    SMS_MSG_SEQ.NEXTVAL	               
				 		,SYSDATE
				 		,'71009171'
				 		,'1'
				 		,'0'			 	 			 	
				 		,#PHONE#
				 		,#CALLBACK#
				 		,#MSG#
				 		,#UCSTMID#
				 		,#NAME#
					) 
    </insert>
    

    <!-- 회원가입 후 안내 메시지 > LMS 전송 정보 입력 -->
    <insert id="sendLmsJoinMessage" parameterClass="HashMap">
	        /* SMSManage.sendLmsJoinMessage */
			INSERT INTO 
				MMS_MSG 
					(
						MSGKEY
						,REQDATE
						,ID
						,STATUS
						,PHONE       /* 수신번호 */
						,CALLBACK    /* 발신번호 */
						,SUBJECT    
						,MSG
						,FILE_CNT
						,ETC1
						,ETC2
					) 
			VALUES    
					(
					    MMS_MSG_SEQ.NEXTVAL
				 		,SYSDATE
				 		,'71009171'
				 		,'1'
				 		,#PHONE#
				 		,#CALLBACK#
				 		,'아모레퍼시픽 고객연구센터'
				 		,#MSG#
				 		,1
				 		,#UCSTMID#
				 		,#NAME#
					) 
    </insert>
    
    
   	<!-- SMS, Email 전송 이력 등록 -->
    <insert id="insertSmsHistory" parameterClass="HashMap">
        /* SMSManage.insertSmsHistory */
		INSERT INTO 
			RDSH101HT 
			(
				SEND_MNG_NO 
				,EXAM_MNG_NO 
				,USER_IDS 
				,SENDER 
				,SEND_TITLE
				,SEND_DATE
			)
		    VALUES 
		    (
		   		RDSH101HT_SEQ.NEXTVAL
		        ,#EXAM_MNG_NO#
		        ,#USER_IDS#
        		<isNotEmpty property="SEND_GBN">
		 		,(SELECT X.VALUE FROM RDCM102DT X WHERE X.COMM_CD = 'TEAM_GBN' AND X.CODE = #AUTH_GBN#) || '팀'
		 		</isNotEmpty>
		 		<isEmpty property="SEND_GBN">
		 		,#SENDER#
		 		</isEmpty>
		        ,#SEND_TITLE#
		        ,TO_CHAR(SYSDATE, 'YYYYMMDD')		               			 
		    ) 
    </insert>
    
    
    <!-- SMS TEAM_TEL 가져오기 -->
    <select id="getTeamTel" parameterClass="HashMap" resultClass="HashMap">
    	SELECT X.VALUE AS TEAM_TEL FROM RDCM102DT X WHERE X.COMM_CD = 'TEAM_GBN_TEL' AND X.CODE = #AUTH_GBN#
    </select>
    
</sqlMap>
