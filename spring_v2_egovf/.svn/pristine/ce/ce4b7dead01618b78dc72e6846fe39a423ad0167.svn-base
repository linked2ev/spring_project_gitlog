<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>

<jsp:include page="/WEB-INF/jsp/fo/include/head.jsp" />
</head>

<body>

<!-- header -->
<jsp:include page="/WEB-INF/jsp/fo/include/header/headerPanel${panelAuth }.jsp" />
<!-- // header -->

<!-- main -->
<main id="main" class="main respWidth">
	<div class="containerWrap">

		<div class="pageWrap rndAddInfo">
			
			<div class="page-title">
				<h2><spring:message code="menu.018"/></h2>
				<div class="page-location">
					<span class="home"><spring:message code="menu.010"/></span> - <spring:message code="menu.017"/> - <b><spring:message code="menu.018"/></b>
				</div>
			</div>

			<div class="page-content">
				<form id="form" name="form">
					<input type="hidden" name="termAgree" id="termAgree" value="<c:out value="${commandMap.termAgree}"/>">
					<input type="hidden" name="termAgree2" id="termAgree2" value="<c:out value="${commandMap.termAgree2}"/>">
					<input type="hidden" name="NAME" id="NAME" value="<c:out value="${info.CSTMNM}"/>">
					
					<span class="txtRed"><spring:message code="joinStep.008"/></span>
					
				<div class="tblWrap tbl-wm">
					<table>
						<caption><spring:message code="member.000"/></caption>
						<colgroup>
							<col width="22%">
							<col width="78%">
						</colgroup>
						<tbody>
							<tr>
								<th><spring:message code="member.001"/></th>
								<td><c:out value="${info.CSTMNM }"/></td>
							</tr>
							<tr>
								<th><spring:message code="member.002"/></th>
								<td>
									<ul class="divForm phoneNo">
										<li>
											<select id="PHONE1" name="PHONE1" class="inputBox requireFileld" title="<spring:message code="member.003"/>">
												<c:if test="${not empty PHONE1_CD_LIST }">
			                                        <c:forEach var="codeRow" items="${PHONE1_CD_LIST }" varStatus="i">
			                                            <option value="<c:out value="${codeRow.VALUE }"/>" <c:if test="${codeRow.VALUE eq info.PHONE1 }">selected="selected"</c:if>>
			                                                <c:out value="${codeRow.VALUE }"/>
			                                            </option>
			                                        </c:forEach>
			                                    </c:if>
											</select>
										</li>
										<li class="divLetter"><span>-</span></li>
										<li><input type="tel" id="PHONE2" name="PHONE2" class="inputBox fnNumber requireFileld" maxlength="4" title="<spring:message code="member.004"/>" value="<c:out value="${info.PHONE2}"/>" ></li>
										<li class="divLetter"><span>-</span></li>
										<li><input type="tel" id="PHONE3" name="PHONE3" class="inputBox fnNumber requireFileld" maxlength="4" title="<spring:message code="member.005"/>" value="<c:out value="${info.PHONE3}"/>" ></li>
									</ul>
								</td>
							</tr>
							<c:if test="${info.EMAIL2 eq 'amorepacific.com'}">
								<tr> 
									<th><spring:message code="member.018"/></th>
									<td>
										<div class="divForm">
			                                <c:if test="${!empty info.EMAIL1}"><c:set var="EMAIL" value="${info.EMAIL1 }@${info.EMAIL2 }" /></c:if>
			                                <input type="eamil" id="EMAIL" name="EMAIL" class="inputBox" title="<spring:message code="member.018"/>" readonly value="<c:out value="${EMAIL }" />" style="width:250px;">
		                                
											<button type="button" class="btn btn-5th btn-blue" id="fn_goPanelCert"><spring:message code="member.025"/></button>
											<input type="text" id="CERT_RANDOMNUM" name="CERT_RANDOMNUM" class="inputBox fnNumber" style="width:100px;">
											<input type="hidden" id="CERT_RANDOMNUM2" name="CERT_RANDOMNUM2">
											<input type="hidden" id="PENRNR_CERT_FLAG" name="PENRNR_CERT_FLAG" value="Y">
										</div>
									</td>
								</tr>
							</c:if>
							<tr>
								<th><spring:message code="member.006"/></th>
								<td>
									<div class="divCheck">
										<input type="radio" id="infoMale" name="GENDER_CD" class="requireFileld" <c:if test="${info.GENDER_CD eq 'M' }">checked="checked"</c:if> value="M" title="<spring:message code="member.006"/>">
										<label for="infoMale"><spring:message code="member.007"/></label>
										<input type="radio" id="infoFemale" name="GENDER_CD" class="requireFileld" <c:if test="${info.GENDER_CD eq 'W' }">checked="checked"</c:if> value="W" title="<spring:message code="member.006"/>">
										<label for="infoFemale"><spring:message code="member.008"/></label>
									</div>
								</td>
							</tr>
							<tr>
								<th><spring:message code="member.009"/></th>
								<td>
									<ul class="divForm birthDay">
										<li>
											<select id="YEAR" name="YEAR" class="inputBox">  
												<c:set var="today" value="<%=new java.util.Date()%>" />
										        <fmt:formatDate value="${today}" pattern="yyyy" var="start"/> 
										            <c:forEach begin="10" end="100" var="idx" step="1">
											            <option value="<c:out value="${start -idx}" />" <c:if test="${start -idx eq info.YEAR }">selected="selected"</c:if> > 
															<c:out value="${start -idx}" />
														</option>
										          	</c:forEach>
											</select>
										</li>
										<li class="divLetter"><span><spring:message code="member.010"/></span></li>
										<li>
											<select id="MONTH" name="MONTH" class="inputBox">
									            <c:forEach begin="1" end="12" var="idx" step="1"> 
										            <option value="<c:out value="${begin + idx}" />" <c:if test="${begin + idx eq info.MONTH }">selected="selected"</c:if> > 
														<c:out value="${begin + idx}" />
													</option>
									          	</c:forEach>
											</select>		 						
										</li>
										<li class="divLetter"><span><spring:message code="member.011"/></span></li>
										<li>
											<select id="DAY" name="DAY" class="inputBox">
												<c:forEach begin="1" end="31" var="idx" step="1"> 
										            <option value="<c:out value="${begin + idx}" />" <c:if test="${begin + idx eq info.DAY }">selected="selected"</c:if> > 
														<c:out value="${begin + idx}" />
													</option>
									          	</c:forEach>
											</select>								
										</li>
										<li class="divLetter"><span><spring:message code="member.012"/></span></li>
									</ul>
								</td>
							</tr>
							<tr>
								<th><spring:message code="member.013"/></th>
								<td>
									<div class="divCheck">
										<c:forEach var="codeRow" items="${OCCU_AREA_LIST }" varStatus="i">
                                            <input type="radio" id="area<c:out value="${codeRow.CODE }"/>" name="OCCU_AREA_CD" class="requireFileld" <c:if test="${info.OCCU_AREA_CD eq codeRow.CODE }">checked="checked"</c:if> value="<c:out value="${codeRow.CODE }"/>" title="<spring:message code="member.013"/>">
											<label for="area<c:out value="${codeRow.CODE }"/>"><c:out value="${codeRow.VALUE }"/></label>
                                        </c:forEach>
									</div> 
								</td>
							</tr>
							<tr>
								<th><spring:message code="member.014"/></th>
								<td>
									<div class="divCheck">
										<c:forEach var="codeRow" items="${VISIT_PREFER_LIST }" varStatus="i">
                                            <input type="radio" id="visit<c:out value="${codeRow.CODE }"/>" name="VISIT_PREFER_CD" class="requireFileld" <c:if test="${info.VISIT_PREFER_CD eq codeRow.CODE }">checked="checked"</c:if> value="<c:out value="${codeRow.CODE }"/>" title="<spring:message code="member.014"/>">
											<label for="visit<c:out value="${codeRow.CODE }"/>"><c:out value="${codeRow.VALUE }"/></label>
                                        </c:forEach>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<div class="btn-wrap btnC">
					<c:if test="${commandMap.termAgree eq 'Y'}">
						<button type="button" class="btn btn-prim btn-white wd100" id="fn_goMemberJoinStep1"><spring:message code="button.003"/></button>
					</c:if>
					<button type="button" class="btn btn-prim btn-red wd100" id="fn_goMemberJoinStep3"><spring:message code="button.004"/></button>
				</div>
			</form>
			
			</div><!-- // page-content -->
		</div><!-- // pageWrap -->

	</div><!-- // container -->
</main>
<!-- // main -->

<!-- footer -->
<jsp:include page="/WEB-INF/jsp/fo/include/footer.jsp" />
<!-- // footer -->
	
<script>
$(function(){
	
    // 이메일 적용 변경 이벤트
/*     $(document).on("change", "select[name='EMAIL_APPLY']", function () {

    	if($("select[name='EMAIL_APPLY']").val() == 'Y'){
    		$("#EMAIL").addClass("requireFileld");
    		$("#EMAIL").addClass("email");
    		$("#EMAIL").show();
    		$("#fn_goPanelCert").show();
    		$("#PENRNR_CERT_FLAG").val("Y");
    		$("#CERT_RANDOMNUM").show();
    	}else{
    		$("#EMAIL").removeClass("requireFileld");
    		$("#EMAIL").removeClass("email");
    		$("#EMAIL").hide();
    		$("#fn_goPanelCert").hide();
    		$("#PENRNR_CERT_FLAG").val("N");
    		$("#CERT_RANDOMNUM").hide();
    	}
    }); */
    // ---------------
    
	// 회원가입 추가정보 이동
	$(document).on("click", "#fn_goMemberJoinStep3", function(){
		
		// FORM 필수값 검사
		if(isEmptyForm("form")){
			
/* 			if($("select[name='EMAIL_APPLY']").val() == 'N'){
				$("#EMAIL").val("");
			} */
			
			// 사내 패널인 경우 > 수신
			if($("#PENRNR_CERT_FLAG").val() == "Y"){
				if($("#CERT_RANDOMNUM2").val() == "" || $("#CERT_RANDOMNUM2").val() == null){
					returnMsg.alertMsg(fnLang("임직원 인증번호를 입력해주세요.", "LC00"));
					$("#CERT_RANDOMNUM").val("");
					return;
				}
				if($("#CERT_RANDOMNUM").val() != $("#CERT_RANDOMNUM2").val()){
					returnMsg.alertMsg(fnLang("인증번호가 틀렸습니다. 다시 한번 확인해주세요.", "LC01"));
					$("#CERT_RANDOMNUM").val("");
					return;
				}
				$("#PENRNR_CERT_FLAG").val("C");
			}
			
        	$("#form").attr({"action":"<c:url value='/fo/mj/memberJoinStep3.do'/>", "target":"_self", "method":"post"}).submit();
		}
	});
	
	// 임직원 인증 버튼 클릭 이벤트
	$(document).on("click", "#fn_goPanelCert", function(){
		var EMAIL = $("#EMAIL").val();
		
		if(!isCheckEmail( EMAIL )){
			returnMsg.alertMsg(fnLang("이메일 형식을 다시 확인해주세요.", "LC02"));
			$("#EMAIL").val("");
			$("#EMAIL").focus();
			return;
		};
		
		// 이메일 인증
    	if(EMAIL.indexOf("amorepacific.com") > -1)
    	{
         	$.ajax({
	        	async : false,
	            type : "POST",
	            dataType: "json",
	            data : {"EMAIL": EMAIL},
	            url : "<c:url value='/fo/mj/panelCertProc.do'/>",
	            success : function (data){
	            	//console.log(">> [fn_goPanelCert] : ", data);
	                if(data.randomNum != null)
	                {
                		returnMsg.alertMsg(data.alertMsg);
                		$("#CERT_RANDOMNUM2").val(data.randomNum);
	                }
	                else
	                {
	                    returnMsg.alertMsg(data.alertMsg, "");
	                }
	                // $(".btn-closePop").click(); 
	            },
	            error : function (err){
	            	returnMsg.alertMsg(fnLang("데이터 처리 중 시스템 오류가 발생했습니다.", err.status), "reload");
	            }
	        });
    	}
    	else
    	{
    		returnMsg.alertMsg(fnLang("임직원 인증이 불가능한 이메일입니다.", "LC03"));
    	}
	});
	
	// 이전 버튼 클릭 이벤트
	$(document).on("click", "#fn_goMemberJoinStep1", function(){
        $("#form").attr({"action":"<c:url value='/fo/mj/memberJoinStep1.do'/>", "target":"_self", "method":"post"}).submit();
	});
	
});
</script>

</body>
</html>